# Архитектура

## Принципы
- Expo + React Native + TypeScript с строгой типизацией и минимумом `any`.
- Простые экраны и понятные CTA для водителей с разным уровнем цифровой грамотности.
- Разделение на слои: UI-атомы, экраны, сервисы работы с хранилищем, навигация и контексты.
- Никаких собственных VPN-протоколов: только инструкции, проверка доступности и deeplink/подсказки.

## Структура каталогов
- `src/screens` — экраны Onboarding, Login, Home, Profile, Instructions, Settings.
- `src/components/ui` — AppButton, AppText, StatusBadge (единообразные контролы на базе React Native Paper).
- `src/components/common` — ScreenLayout с заголовком, LoadingOverlay, ErrorState.
- `src/navigation` — конфигурация стек-навигации и нижних табов.
- `src/services` — `storageService` с типизированной работой с AsyncStorage.
- `src/hooks` — `AppStateContext` с глобальным состоянием (тема, профиль, флаги онбординга, глобальная загрузка).
- `src/types` — типы профиля, настроек и навигации.
- `src/utils` — вспомогательные функции (например, сборка темы Paper).

## Потоки данных
1. При старте `AppStateContext` читает флаги онбординга/темы/профиля из AsyncStorage.
2. `AppNavigator` выбирает начальный экран (Onboarding → Login → MainTabs) и стартовую вкладку (Instructions по флагу настроек или Home).
3. `LoginScreen` валидирует данные и сохраняет профиль в хранилище.
4. `HomeScreen` отображает статус VPN (визуальный), открывает клиент через deeplink/подсказку и выполняет проверку доступности через HTTP-запрос.
5. `ProfileScreen` и `SettingsScreen` читают данные из контекста, позволяют копировать параметры и переключать тему/флаги.

## Обработка ошибок и состояния
- Глобальный оверлей загрузки (`LoadingOverlay`) управляется из контекста (`setGlobalLoading`).
- Ошибки чтения/записи AsyncStorage логируются в консоль, на UI выводятся лаконичные сообщения через `ErrorState` и диалоги.

## Темы и UI
- React Native Paper (MD3) с кастомным цветом акцента; светлая/тёмная темы сохраняются в AsyncStorage.
- Шрифты и размеры по умолчанию Paper обеспечивают читаемость на ходу; кнопки и бэйджи крупные и контрастные.
